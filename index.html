<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catastro de Laboratorio de Biología</title>
    <!-- Tailwind CSS CDN for utility-first styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Three.js CDN for the interactive 3D background -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- Lucide Icons CDN for modern, customizable icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        /* Custom styles for the Three.js canvas to place it in the background */
        #three-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1; /* Ensures content appears on top */
            pointer-events: none; /* Allows mouse events to pass through to elements below */
            opacity: 0.7; /* Slightly transparent for a subtle effect */
        }

        /* Base body styles for font and background */
        body {
            font-family: "Inter", sans-serif;
            background-color: #f0f4f8; /* Light background for content areas */
            color: #333;
            overflow-x: hidden; /* Prevents horizontal scroll on smaller screens */
            transition: background-color 0.3s ease, color 0.3s ease; /* Smooth transition */
        }

        /* Dark mode styles for the body */
        body.dark-mode {
            background-color: #1a202c; /* Dark background */
            color: #e2e8f0; /* Light text */
        }

        /* Custom scrollbar styling for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #e2e8f0;
            border-radius: 10px;
        }

        /* Dark mode scrollbar track */
        body.dark-mode ::-webkit-scrollbar-track {
            background: #2d3748;
        }

        ::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 10px;
        }

        /* Dark mode scrollbar thumb */
        body.dark-mode ::-webkit-scrollbar-thumb {
            background: #718096;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* Dark mode scrollbar thumb hover */
        body.dark-mode ::-webkit-scrollbar-thumb:hover {
            background: #4a5568;
        }

        /* Styling for content cards, providing a frosted glass effect */
        .card {
            background-color: rgba(255, 255, 255, 0.9); /* Semi-transparent white */
            backdrop-filter: blur(5px); /* Blurs content behind the card */
            border-radius: 1rem; /* Rounded corners */
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1); /* Subtle shadow */
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(226, 232, 240, 0.5); /* Light border */
            transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }

        /* Dark mode card styles */
        body.dark-mode .card {
            background-color: rgba(45, 55, 72, 0.9); /* Darker semi-transparent */
            border: 1px solid rgba(74, 85, 104, 0.5); /* Darker border */
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.3); /* More pronounced shadow */
        }

        /* Styling for section titles with a blue underline effect */
        .section-title {
            position: relative;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .section-title::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 60px;
            height: 4px;
            background-color: #3b82f6; /* Blue underline */
            border-radius: 2px;
        }

        /* Style for the expandable details button */
        .expand-button {
            cursor: pointer;
            font-weight: bold;
            color: #3b82f6; /* Blue color for emphasis */
            transition: color 0.2s; /* Smooth color transition on hover */
        }
        .expand-button:hover {
            color: #2563eb; /* Darker blue on hover */
        }

        /* Table specific styles for dark mode */
        body.dark-mode table thead th {
            background-color: #2d3748; /* Darker header background */
            color: #e2e8f0; /* Lighter text for headers */
        }

        body.dark-mode table tbody tr {
            background-color: #4a5568; /* Darker row background */
            border-color: #2d3748; /* Darker border */
        }

        body.dark-mode table tbody tr:hover {
            background-color: #64748b; /* Lighter hover for dark mode */
        }

        /* Styles for specific elements in dark mode */
        body.dark-mode .bg-blue-50 { /* For microscope brand descriptions and detail rows */
            background-color: #2d3748;
            border-color: #4a5568;
            color: #e2e8f0;
        }

        body.dark-mode .text-blue-800 {
            color: #90cdf4; /* Lighter blue for titles in dark mode */
        }

        body.dark-mode .text-gray-700 {
            color: #cbd5e0; /* Lighter gray for general text */
        }

        body.dark-mode .text-gray-600 {
            color: #a0aec0; /* Lighter gray for subtle text */
        }

        body.dark-mode .text-blue-600 {
            color: #63b3ed; /* Adjusted blue for dark mode */
        }

        /* Status colors in dark mode */
        body.dark-mode .text-green-600 { color: #81c784; } /* Lighter green */
        body.dark-mode .text-blue-600 { color: #63b3ed; } /* Lighter blue */
        body.dark-mode .text-yellow-600 { color: #ffd54f; } /* Lighter yellow */
        body.dark-mode .text-red-600 { color: #ef9a9a; } /* Lighter red */

        /* Dark mode styles for search input fields */
        body.dark-mode input[type="text"] {
            background-color: #2d3748; /* Darker background for input */
            color: #e2e8f0; /* Lighter text for input */
            border-color: #4a5568; /* Darker border for input */
        }
        body.dark-mode input[type="text"]::placeholder {
            color: #a0aec0; /* Lighter placeholder text */
        }
        body.dark-mode input[type="text"]:focus {
            border-color: #63b3ed; /* Blue focus ring for dark mode */
            box-shadow: 0 0 0 2px rgba(99, 179, 237, 0.5); /* Blue shadow for focus */
        }


        /* Mobile navigation menu styles */
        .mobile-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 50;
            display: flex;
            justify-content: center;
            align-items: center;
            transform: translateX(100%); /* Start off-screen to the right */
            transition: transform 0.3s ease-out; /* Smooth slide-in/out */
        }

        .mobile-menu-overlay.open {
            transform: translateX(0); /* Slide in */
        }

        .mobile-menu-overlay ul {
            list-style: none;
            padding: 0;
            text-align: center;
        }

        .mobile-menu-overlay ul li {
            margin: 1.5rem 0;
        }

        .mobile-menu-overlay ul li a {
            color: white;
            font-size: 1.8rem;
            text-decoration: none;
            transition: color 0.2s;
        }

        .mobile-menu-overlay ul li a:hover {
            color: #a7d9ff;
        }

        .close-menu-button {
            position: absolute;
            top: 1.5rem;
            right: 1.5rem;
            background: none;
            border: none;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            z-index: 60;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col">
    <!-- Three.js Canvas for Background -->
    <canvas id="three-background"></canvas>

    <!-- Header Section: Contains institution and career logos, title, and navigation -->
    <header class="bg-gradient-to-r from-blue-600 to-blue-800 text-white p-6 shadow-lg relative z-10">
        <div class="container mx-auto flex flex-col md:flex-row items-center justify-between">
            <!-- University Logo and Main Lab Title -->
            <div class="flex items-center mb-4 md:mb-0 w-full md:w-auto justify-center md:justify-start">
                <!-- University Logo (Universidad de Playa Ancha) -->
                <img src="https://placehold.co/80x80/000000/FFFFFF?text=UPLA" alt="Logo Universidad de Playa Ancha" class="h-16 w-16 md:h-20 md:w-20 rounded-full mr-4 border-2 border-white object-cover">
                <h1 class="text-3xl md:text-4xl font-extrabold text-center md:text-left">
                    <i data-lucide="flask-conical" class="inline-block mr-2 w-8 h-8 md:w-10 md:h-10"></i>
                    Laboratorio de Microscopía
                </h1>
            </div>
            
            <!-- Career Title and Logo -->
            <div class="flex items-center flex-col md:flex-row w-full md:w-auto justify-center md:justify-end text-center md:text-right">
                <h2 class="text-xl md:text-2xl font-semibold md:mr-4 mb-2 md:mb-0">
                    Carrera de Pedagogía en Biología y Ciencias
                </h2>
                <!-- Career Logo -->
                <img src="https://placehold.co/80x80/000000/FFFFFF?text=BIOCIE" alt="Logo Carrera de Pedagogía en Biología y Ciencias" class="h-16 w-16 md:h-20 md:w-20 rounded-full border-2 border-white object-cover">
            </div>

            <!-- Hamburger Menu Button for Mobile -->
            <button id="menu-toggle" class="md:hidden absolute top-6 right-6 text-white focus:outline-none">
                <i data-lucide="menu" class="w-8 h-8"></i>
            </button>

            <!-- Theme Toggle Button -->
            <button id="theme-toggle" class="absolute top-6 right-20 text-white focus:outline-none md:right-6">
                <!-- Icon will be set by JavaScript based on current theme -->
            </button>
        </div>

        <!-- Desktop Navigation Menu -->
        <nav class="hidden md:flex mt-6 justify-center w-full">
            <ul class="flex flex-wrap space-x-6 text-lg font-medium">
                <li><a href="#microscopios" class="hover:text-blue-200 transition duration-300 p-2 rounded-md hover:bg-blue-700">Microscopios</a></li>
                <li><a href="#equipos" class="hover:text-blue-200 transition duration-300 p-2 rounded-md hover:bg-blue-700">Equipos</a></li>
                <li><a href="#material-vidrio" class="hover:text-blue-200 transition duration-300 p-2 rounded-md hover:bg-blue-700">Material de Vidrio</a></li>
                <li><a href="#reactivos" class="hover:text-blue-200 transition duration-300 p-2 rounded-md hover:bg-blue-700">Reactivos</a></li>
                <li><a href="#muestras" class="hover:text-blue-200 transition duration-300 p-2 rounded-md hover:bg-blue-700">Muestras Histológicas</a></li>
            </ul>
        </nav>
    </header>

    <!-- Mobile Navigation Overlay -->
    <div id="mobile-menu-overlay" class="mobile-menu-overlay">
        <button id="close-menu" class="close-menu-button">
            <i data-lucide="x"></i>
        </button>
        <ul>
            <li><a href="#microscopios" class="mobile-nav-link">Microscopios</a></li>
            <li><a href="#equipos" class="mobile-nav-link">Equipos</a></li>
            <li><a href="#material-vidrio" class="mobile-nav-link">Material de Vidrio</a></li>
            <li><a href="#reactivos" class="mobile-nav-link">Reactivos</a></li>
            <li><a href="#muestras" class="mobile-nav-link">Muestras Histológicas</a></li>
        </ul>
    </div>

    <!-- Main Content Area -->
    <main class="flex-grow container mx-auto px-4 py-8 md:px-8 md:py-12 relative z-10">
        <!-- Introduction Section -->
        <section class="card mb-8 text-center">
            <h2 class="text-3xl font-bold text-blue-700 section-title mx-auto w-fit mb-6">
                Bienvenido al Catastro del Laboratorio
            </h2>
            <p class="text-lg text-gray-700 leading-relaxed">
                Esta plataforma le permite visualizar y gestionar el inventario de nuestro laboratorio de docencia en Biología Celular y Molecular, Histología Animal y Vegetal, y Microbiología.
                Aquí encontrará información detallada sobre microscopios, equipos, material de vidrio, reactivos y nuestra valiosa colección de muestras histológicas.
            </p>
        </section>

        <!-- Microscopes Section -->
        <section id="microscopios" class="card">
            <h2 class="text-3xl font-bold text-blue-700 section-title">
                <i data-lucide="microscope" class="inline-block mr-2 w-8 h-8"></i>
                Microscopios
            </h2>
            <p class="text-gray-600 mb-4">
                A continuación, se presenta el listado de microscopios disponibles en el laboratorio.
            </p>

            <!-- Brand Descriptions Section: Provides general information about each microscope brand -->
            <div id="microscope-brand-descriptions" class="mb-8 grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-blue-50 p-4 rounded-lg shadow-inner border border-blue-200">
                    <h3 class="text-xl font-semibold text-blue-800 mb-2">American Optical</h3>
                    <p class="text-gray-700 text-sm">Construidos en EE. UU., los microscopios American Optical son conocidos por su durabilidad, calidad óptica y fiabilidad en laboratorios, hospitales y aulas. Modelo presente: <span class="text-blue-600 font-semibold">ONE FIFTY</span>.</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg shadow-inner border border-blue-200">
                    <h3 class="text-xl font-semibold text-blue-800 mb-2">NIKON</h3>
                    <p class="text-gray-700 text-sm">Con más de 100 años de experiencia, Nikon es una marca de renombre mundial a la vanguardia de la innovación óptica y tecnológica. Fabrica su propio vidrio para asegurar la máxima calidad y ofrece un amplio catálogo para educación, clínica, ciencia de materiales e investigación. Modelos presentes: <span class="text-blue-600 font-semibold">123M-B1</span>, <span class="text-blue-600 font-semibold">123M</span>.</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg shadow-inner border border-blue-200">
                    <h3 class="text-xl font-semibold text-blue-800 mb-2">CARTON</h3>
                    <p class="text-gray-700 text-sm">Fabricante japonés (desde la década de 1930) de ópticas de precisión y productos ópticos como microscopios, binoculares y telescopios. Reconocido por la calidad de sus ópticas en mercados educativos e industriales, minimizando la fatiga ocular. Modelo presente: <span class="text-blue-600 font-semibold">NA</span>.</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg shadow-inner border border-blue-200">
                    <h3 class="text-xl font-semibold text-blue-800 mb-2">Euromex</h3>
                    <p class="text-gray-700 text-sm">Fabricante líder de microscopios e instrumentos ópticos desde 1966, con sede en Holanda. Ofrece una amplia selección para aplicaciones educativas, industriales y clínicas, destacando por su innovadora tecnología óptica. Modelos presentes: <span class="text-blue-600 font-semibold">BioBlue</span>, <span class="text-blue-600 font-semibold">BioBlue.LabTrinocular</span>, <span class="text-blue-600 font-semibold">BioBlue.Lab</span>.</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg shadow-inner border border-blue-200">
                    <h3 class="text-xl font-semibold text-blue-800 mb-2">Lieder</h3>
                    <p class="text-gray-700 text-sm">Principalmente conocido por fabricar material didáctico para escuelas y educación, incluyendo portaobjetos de microscopio preparados de alta calidad y paquetes multimedia para biología microscópica. Modelo presente: <span class="text-blue-600 font-semibold">MC 319</span>.</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg shadow-inner border border-blue-200">
                    <h3 class="text-xl font-semibold text-blue-800 mb-2">Motic</h3>
                    <p class="text-gray-700 text-sm">Establecida en 1988, Motic es una marca global especializada en la fabricación de microscopios compuestos convencionales. Ha incursionado en soluciones de microscopía digital asequibles, convirtiéndose en un referente en productos de microscopía digital. Modelo presente: <span class="text-blue-600 font-semibold">B1 Series</span>.</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg shadow-inner border border-blue-200">
                    <h3 class="text-xl font-semibold text-blue-800 mb-2">Leica</h3>
                    <p class="text-gray-700 text-sm">Marca líder que ofrece instrumentos ópticos de alta calidad, incluyendo microscopios estéreo y compuestos. Con un fuerte compromiso con la innovación y la precisión, Leica es una herramienta esencial para investigadores, educadores y profesionales en diversos campos científicos. Modelo presente: <span class="text-blue-600 font-semibold">1349522x</span>.</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg shadow-inner border border-blue-200">
                    <h3 class="text-xl font-semibold text-blue-800 mb-2">QUIMIS (WINKLER)</h3>
                    <p class="text-gray-700 text-sm">Quimis Aparelhos Científicos LTDA es el mayor fabricante de equipos de laboratorio en América Latina. Sus microscopios son reconocidos por su excelente calidad de imagen, aptos para laboratorios, industria y educación. Modelo presente: <span class="text-blue-600 font-semibold">708-4</span>.</p>
                </div>
                <div class="bg-blue-50 p-4 rounded-lg shadow-inner border border-blue-200">
                    <h3 class="text-xl font-semibold text-blue-800 mb-2">SDPTOP</h3>
                    <p class="text-gray-700 text-sm">Asociada con Sunny Optical, SDPTOP es conocida por sus microscopios biológicos (como el modelo EX20). Se centran en diseños estables y sólidos con un rendimiento excelente, alta resolución y sistemas ópticos profesionales, adecuados para educación y laboratorios. Modelo presente: <span class="text-blue-600 font-semibold">EX20</span>.</p>
                </div>
            </div>
            <!-- End Brand Descriptions Section -->

            <!-- Search input for the microscopes table -->
            <input type="text" id="search-microscopios" placeholder="Buscar microscopio..." class="rounded-md border border-gray-300 p-2 mb-4 w-full focus:ring-blue-500 focus:border-blue-500">
            <div class="overflow-x-auto">
                <table class="table-auto w-full text-left whitespace-no-wrap">
                    <thead>
                        <tr>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100 rounded-tl rounded-bl">ID</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Marca</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Modelo</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Tipo</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Estado</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Ubicación</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100 rounded-tr rounded-br">Notas</th>
                        </tr>
                    </thead>
                    <tbody id="microscopes-table-body">
                        <!-- Microscope rows will be injected here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Equipment Section -->
        <section id="equipos" class="card">
            <h2 class="text-3xl font-bold text-blue-700 section-title">
                <i data-lucide="settings" class="inline-block mr-2 w-8 h-8"></i>
                Equipos Mayores
            </h2>
            <p class="text-gray-600 mb-4">
                Detalle de los equipos principales del laboratorio.
            </p>
            <!-- Search input for the equipment table -->
            <input type="text" id="search-equipos" placeholder="Buscar equipo..." class="rounded-md border border-gray-300 p-2 mb-4 w-full focus:ring-blue-500 focus:border-blue-500">
            <div class="overflow-x-auto">
                <table class="table-auto w-full text-left whitespace-no-wrap">
                    <thead>
                        <tr>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100 rounded-tl rounded-bl">Nombre</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Ubicación</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100 rounded-tr rounded-br">Función</th>
                        </tr>
                    </thead>
                    <tbody id="equipment-table-body">
                        <!-- Equipment rows will be injected here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Glassware Section -->
        <section id="material-vidrio" class="card">
            <h2 class="text-3xl font-bold text-blue-700 section-title">
                <i data-lucide="flask-round" class="inline-block mr-2 w-8 h-8"></i>
                Material de Vidrio
            </h2>
            <p class="text-gray-600 mb-4">
                Inventario del material de vidrio disponible para las prácticas.
            </p>
            <!-- Search input for the glassware table -->
            <input type="text" id="search-material-vidrio" placeholder="Buscar material de vidrio..." class="rounded-md border border-gray-300 p-2 mb-4 w-full focus:ring-blue-500 focus:border-blue-500">
            <div class="overflow-x-auto">
                <table class="table-auto w-full text-left whitespace-no-wrap">
                    <thead>
                        <tr>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100 rounded-tl rounded-bl">Tipo</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100 rounded-tr rounded-br">Descripción/Volúmenes</th>
                        </tr>
                    </thead>
                    <tbody id="glassware-table-body">
                        <!-- Glassware rows will be injected here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Reagents Section -->
        <section id="reactivos" class="card">
            <h2 class="text-3xl font-bold text-blue-700 section-title">
                <i data-lucide="syringe" class="inline-block mr-2 w-8 h-8"></i>
                Reactivos Químicos
            </h2>
            <p class="text-gray-600 mb-4">
                Listado de reactivos químicos guardados en el cuarto lateral. Se recomienda mantener un inventario actualizado con fechas de caducidad y cantidades.
            </p>
            <!-- Search input for the reagents table -->
            <input type="text" id="search-reactivos" placeholder="Buscar reactivo..." class="rounded-md border border-gray-300 p-2 mb-4 w-full focus:ring-blue-500 focus:border-blue-500">
            <div class="overflow-x-auto">
                <table class="table-auto w-full text-left whitespace-no-wrap">
                    <thead>
                        <tr>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100 rounded-tl rounded-bl">Nombre</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Fórmula</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Cantidad</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Unidad</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Caducidad</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Proveedor</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Almacenamiento</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100 rounded-tr rounded-br">Riesgo</th>
                        </tr>
                    </thead>
                    <tbody id="reagents-table-body">
                        <!-- Reagents rows will be injected here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Histological Samples Section -->
        <section id="muestras" class="card">
            <h2 class="text-3xl font-bold text-blue-700 section-title">
                <i data-lucide="boxes" class="inline-block mr-2 w-8 h-8"></i>
                Colección de Muestras Histológicas
            </h2>
            <p class="text-gray-600 mb-4">
                Nuestra valiosa colección de muestras histológicas, distribuidas en aproximadamente 10 cajas. Haz clic en "Ver Detalles" para expandir el contenido de cada caja.
            </p>
            <!-- Search input for the samples table -->
            <input type="text" id="search-muestras" placeholder="Buscar muestra..." class="rounded-md border border-gray-300 p-2 mb-4 w-full focus:ring-blue-500 focus:border-blue-500">
            <div class="overflow-x-auto">
                <table class="table-auto w-full text-left whitespace-no-wrap">
                    <thead>
                        <tr>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100 rounded-tl rounded-bl">Caja</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Tipo de Muestra</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100">Notas</th>
                            <th class="px-4 py-3 title-font tracking-wider font-medium text-gray-900 text-sm bg-gray-100 rounded-tr rounded-br">Detalles</th>
                        </tr>
                    </thead>
                    <tbody id="samples-table-body">
                        <!-- Sample rows will be injected here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- Footer Section -->
    <footer class="bg-gray-800 text-white p-6 text-center mt-auto relative z-10">
        <p>&copy; 2025 Laboratorio de Biología. Todos los derechos reservados.</p>
        <p class="text-sm mt-2">Desarrollado con ❤️ y Three.js</p>
    </footer>

    <script>
        // Initialize Lucide icons on page load
        lucide.createIcons();

        // --- Three.js Background Setup ---
        let scene, camera, renderer, particles;
        const particleCount = 3000; // Increased particle count for a denser, more 'cellular' feel
        let baseParticleSize = 0.8; // Base size for individual particles, slightly larger
        const pulsationAmplitude = 0.5; // Magnitude of the pulsation effect, slightly more pronounced
        const pulsationSpeed = 0.001; // Speed of the pulsation animation, slightly slower for organic feel
        const particleDriftSpeed = { x: 0.0005, y: 0.0005, z: 0.0005 }; // Subtle drift for particles

        let mouseX = 0, mouseY = 0; // Mouse coordinates for interactive camera movement
        const windowHalfX = window.innerWidth / 2;
        const windowHalfY = window.innerHeight / 2;

        /**
         * Creates a circular texture for particles using a 2D canvas.
         * This makes particles appear as soft, glowing circles instead of sharp squares.
         * @returns {THREE.CanvasTexture} A Three.js texture object.
         */
        function createParticleTexture() {
            const canvas = document.createElement('canvas');
            canvas.width = 64; // Small resolution is fine for particles
            canvas.height = 64;
            const context = canvas.getContext('2d');
            
            // Draw a radial gradient for a soft, glowing effect
            const gradient = context.createRadialGradient(
                canvas.width / 2, canvas.height / 2, 0,
                canvas.width / 2, canvas.height / 2, canvas.width / 2
            );
            gradient.addColorStop(0, 'rgba(255,255,255,1)'); // Center white
            gradient.addColorStop(0.2, 'rgba(200,200,255,0.8)'); // Light blue/purple
            gradient.addColorStop(0.7, 'rgba(100,100,200,0.4)'); // Mid blue/purple
            gradient.addColorStop(1, 'rgba(0,0,0,0)'); // Transparent edge

            context.fillStyle = gradient;
            context.arc(canvas.width / 2, canvas.height / 2, canvas.width / 2, 0, Math.PI * 2);
            context.fill();

            return new THREE.CanvasTexture(canvas);
        }

        /**
         * Initializes the Three.js scene, camera, renderer, and particles for the background.
         */
        function initThreeJS() {
            // Create a new Three.js scene
            scene = new THREE.Scene();
            // Add a subtle fog to enhance depth perception and create a more atmospheric look
            scene.fog = new THREE.FogExp2(0x000000, 0.001); // Default to dark fog

            // Setup the camera: PerspectiveCamera(FOV, Aspect Ratio, Near Plane, Far Plane)
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 100; // Position the camera further back to encompass more particles

            // Create a WebGL renderer and attach it to the canvas element
            renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('three-background'), antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight); // Set renderer size to full window
            renderer.setPixelRatio(window.devicePixelRatio); // Adjust for high-DPI screens
            renderer.setClearColor(0x000000, 0); // Set background to transparent

            // Create particle geometry and attributes
            const geometry = new THREE.BufferGeometry();
            const positions = []; // Stores x, y, z coordinates for each particle
            const colors = [];    // Stores R, G, B color values for each particle
            const sizes = [];     // Stores individual sizes for particles
            const color = new THREE.Color(); // Helper for color manipulation

            // Generate random positions and biological-themed colors for each particle
            for (let i = 0; i < particleCount; i++) {
                // Random position within a larger cube to fill the background
                positions.push((Math.random() - 0.5) * 800); // X coordinate
                positions.push((Math.random() - 0.5) * 800); // Y coordinate
                positions.push((Math.random() - 0.5) * 800); // Z coordinate

                // Assign biological-themed colors (greens, blues, purples, subtle reds)
                // More emphasis on cellular/microscopic stain colors
                const hue = Math.random();
                if (hue < 0.3) { // Greens (e.g., cytoplasm, plant cells)
                    color.setHSL(0.3 + Math.random() * 0.1, 0.6 + Math.random() * 0.3, 0.5 + Math.random() * 0.2);
                } else if (hue < 0.6) { // Blues (e.g., nuclei stains like DAPI, hematoxylin)
                    color.setHSL(0.6 + Math.random() * 0.1, 0.6 + Math.random() * 0.3, 0.5 + Math.random() * 0.2);
                } else if (hue < 0.8) { // Purples (e.g., Gram stain, mixed stains)
                    color.setHSL(0.8 + Math.random() * 0.1, 0.6 + Math.random() * 0.3, 0.5 + Math.random() * 0.2);
                } else { // Reds/Pinks (e.g., eosin, certain bacteria)
                    color.setHSL(0 + Math.random() * 0.05, 0.6 + Math.random() * 0.3, 0.5 + Math.random() * 0.2);
                }
                colors.push(color.r, color.g, color.b);

                // Assign a slightly varied size to each particle
                sizes.push(baseParticleSize + (Math.random() * 0.5 - 0.25));
            }

            // Set the position, color, and size attributes for the geometry
            geometry.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
            geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));
            geometry.setAttribute('size', new THREE.Float32BufferAttribute(sizes, 1)); // Add size attribute

            // Create a custom shader material for particles to control size and texture
            const material = new THREE.ShaderMaterial({
                uniforms: {
                    color: { value: new THREE.Color(0xffffff) }, // Base color, will be multiplied by vertex colors
                    pointTexture: { value: createParticleTexture() }, // Our custom circular texture
                    size: { value: 1.0 } // Global size multiplier, for pulsation
                },
                vertexShader: `
                    attribute float size;
                    attribute vec3 color;
                    varying vec3 vColor;
                    void main() {
                        vColor = color;
                        vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
                        gl_PointSize = size * ( 300.0 / -mvPosition.z ); // Scale size based on distance
                        gl_Position = projectionMatrix * mvPosition;
                    }
                `,
                fragmentShader: `
                    uniform vec3 color;
                    uniform sampler2D pointTexture;
                    varying vec3 vColor;
                    void main() {
                        gl_FragColor = vec4( color * vColor, 1.0 ); // Combine base color with vertex color
                        gl_FragColor = gl_FragColor * texture2D( pointTexture, gl_PointCoord ); // Apply texture
                        if (gl_FragColor.a < 0.001) discard; // Discard fully transparent pixels
                    }
                `,
                blending: THREE.AdditiveBlending, // For a glowing, ethereal effect
                depthTest: false, // Particles should not occlude each other based on depth
                transparent: true // Enable transparency
            });

            // Create the particle system (Points) and add it to the scene
            particles = new THREE.Points(geometry, material);
            scene.add(particles);

            // Add event listeners for window resizing and mouse movement
            window.addEventListener('resize', onWindowResize, false);
            document.addEventListener('mousemove', onDocumentMouseMove, false);

            // Start the animation loop
            animateThreeJS();
        }

        /**
         * Handles window resize events to update camera aspect ratio and renderer size.
         */
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        }

        /**
         * Handles mouse movement to subtly adjust camera or particle rotation.
         * This creates a parallax effect, making the background feel more dynamic.
         * @param {MouseEvent} event - The mousemove event object.
         */
        function onDocumentMouseMove(event) {
            mouseX = (event.clientX - windowHalfX) * 0.1; // Scale mouse movement
            mouseY = (event.clientY - windowHalfY) * 0.1;
        }

        /**
         * The main animation loop for Three.js.
         * It updates particle rotation, applies a pulsation effect, and simulates drift.
         */
        function animateThreeJS() {
            requestAnimationFrame(animateThreeJS); // Request the next frame

            // Subtle camera movement based on mouse position
            camera.position.x += (mouseX - camera.position.x) * 0.005;
            camera.position.y += (-mouseY - camera.position.y) * 0.005;
            camera.lookAt(scene.position); // Always look at the center of the scene

            // Animate particles by rotating them around their axes
            particles.rotation.x += 0.0001; // Very slow rotation
            particles.rotation.y += 0.0002; // Very slow rotation

            // Apply a subtle pulsation effect to particle size using a sine wave
            particles.material.uniforms.size.value = baseParticleSize + Math.sin(Date.now() * pulsationSpeed) * pulsationAmplitude;

            // Apply subtle continuous drift to particles
            const positions = particles.geometry.attributes.position.array;
            for (let i = 0; i < positions.length; i += 3) {
                positions[i] += particleDriftSpeed.x; // X drift
                positions[i + 1] += particleDriftSpeed.y; // Y drift
                positions[i + 2] += particleDriftSpeed.z; // Z drift

                // Wrap particles around if they go too far, creating an infinite effect
                if (positions[i] > 400) positions[i] = -400;
                if (positions[i] < -400) positions[i] = 400;
                if (positions[i + 1] > 400) positions[i + 1] = -400;
                if (positions[i + 1] < -400) positions[i + 1] = 400;
                if (positions[i + 2] > 400) positions[i + 2] = -400;
                if (positions[i + 2] < -400) positions[i + 2] = 400;
            }
            particles.geometry.attributes.position.needsUpdate = true; // Tell Three.js to update positions

            // Render the scene with the camera
            renderer.render(scene, camera);
        }

        // --- Lab Data Loading ---
        // Function to fetch and render data
        async function loadAndRenderData() {
            try {
                // Fetch the JSON data from the 'data.json' file in the same directory
                const response = await fetch('data.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const labData = await response.json(); // Parse the JSON response

                // Render all data tables using the fetched data
                renderTable(
                    labData.microscopes, // Access the 'microscopes' array from the JSON
                    'microscopes-table-body',
                    ['id', 'brand', 'model', 'type', 'status', 'location', 'notes'],
                    'search-microscopios',
                    getMicroscopeStatusClass
                );

                renderTable(
                    labData.equipment, // Access the 'equipment' array
                    'equipment-table-body',
                    ['name', 'location', 'function'],
                    'search-equipos'
                );

                renderTable(
                    labData.glassware, // Access the 'glassware' array
                    'glassware-table-body',
                    ['type', 'description'],
                    'search-material-vidrio'
                );

                renderTable(
                    labData.reagents, // Access the 'reagents' array
                    'reagents-table-body',
                    ['name', 'formula', 'quantity', 'unit', 'expiration', 'supplier', 'storage', 'hazard'],
                    'search-reactivos'
                );

                renderTable(
                    labData.samples, // Access the 'samples' array
                    'samples-table-body',
                    ['box', 'type', 'notes'],
                    'search-muestras',
                    null,
                    true
                );

            } catch (error) {
                console.error('Error loading lab data:', error);
                // Optionally, display an error message to the user on the page
                const mainContent = document.querySelector('main');
                const errorMessage = document.createElement('p');
                errorMessage.className = 'text-red-500 text-center text-xl mt-8';
                errorMessage.textContent = 'No se pudieron cargar los datos del laboratorio. Por favor, inténtalo de nuevo más tarde.';
                mainContent.prepend(errorMessage);
            }
        }

        /**
         * Renders data into a table and sets up search functionality.
         * @param {Array<Object>} data - The array of data objects to render.
         * @param {string} tableBodyId - The ID of the tbody element where rows will be appended.
         * @param {Array<string>} headers - An array of keys from the data objects to use as column headers.
         * @param {string} searchInputId - The ID of the search input element associated with this table.
         * @param {function(Object): string} [statusClassFn] - Optional function to determine a CSS class for 'status' column (e.g., for microscopes).
         * @param {boolean} [expandableRows=false] - True if rows should have expandable details (e.g., for samples).
         */
        function renderTable(data, tableBodyId, headers, searchInputId, statusClassFn = null, expandableRows = false) {
            const tableBody = document.getElementById(tableBodyId);
            if (!tableBody) {
                console.error(`Error: Element with ID '${tableBodyId}' not found.`);
                return;
            }
            tableBody.innerHTML = ''; // Clear existing content to prevent duplicates on re-render

            data.forEach((item, index) => {
                const row = document.createElement('tr');
                row.className = 'bg-white border-b-2 border-gray-200 hover:bg-gray-50';
                row.setAttribute('data-row-index', index); // Store index for linking with detail rows

                // Create a combined string for search filtering
                let searchString = '';
                headers.forEach(header => {
                    searchString += (item[header] || '').toString().toLowerCase() + ' ';
                });
                // Include details in search string if applicable
                if (expandableRows && item.details) {
                    searchString += item.details.map(d => d.toLowerCase()).join(' ') + ' ';
                }
                row.setAttribute('data-search-term', searchString.trim());

                // Populate cells based on headers
                headers.forEach(header => {
                    const cell = document.createElement('td');
                    cell.className = 'px-4 py-3';
                    let cellContent = item[header] || '';

                    // Apply specific styling for microscope status if function is provided
                    if (statusClassFn && header === 'status') {
                        const span = document.createElement('span');
                        span.className = statusClassFn(item);
                        span.textContent = cellContent;
                        cell.appendChild(span);
                    } else {
                        cell.textContent = cellContent;
                    }
                    row.appendChild(cell);
                });

                // Add expandable details button if enabled and details exist
                if (expandableRows && item.details && item.details.length > 0) {
                    const detailsCell = document.createElement('td');
                    detailsCell.className = 'px-4 py-3';
                    const expandButton = document.createElement('span');
                    expandButton.className = 'expand-button';
                    expandButton.textContent = 'Ver Detalles';
                    // Attach click listener to toggle details visibility
                    expandButton.onclick = function() {
                        toggleDetails(index, headers.length + 1, expandButton); // Pass button element
                    };
                    detailsCell.appendChild(expandButton);
                    row.appendChild(detailsCell);
                } else if (expandableRows) {
                    // Add an empty cell if expandableRows is true but no details
                    const emptyDetailsCell = document.createElement('td');
                    emptyDetailsCell.className = 'px-4 py-3';
                    row.appendChild(emptyDetailsCell);
                }

                tableBody.appendChild(row);

                // Create and append the hidden detail row if expandableRows is enabled
                if (expandableRows && item.details && item.details.length > 0) {
                    const detailRow = document.createElement('tr');
                    detailRow.id = `details-row-${index}`;
                    // Initially hidden, and stores user's expanded state
                    detailRow.className = 'hidden bg-blue-50 border-b border-blue-200';
                    detailRow.setAttribute('data-user-expanded', 'false'); // Tracks if user explicitly expanded it

                    const detailCell = document.createElement('td');
                    // colSpan ensures the detail row spans across all columns of the main table
                    detailCell.colSpan = headers.length + (expandableRows ? 1 : 0);
                    detailCell.className = 'px-4 py-3 text-gray-700';
                    
                    const detailList = document.createElement('ul');
                    detailList.className = 'list-disc list-inside ml-4';
                    item.details.forEach(detail => {
                        const listItem = document.createElement('li');
                        listItem.textContent = detail;
                        detailList.appendChild(listItem);
                    });
                    detailCell.appendChild(detailList);
                    detailRow.appendChild(detailCell);
                    tableBody.appendChild(detailRow);
                }
            });

            // Setup search functionality for this table after all rows are rendered
            setupSearch(searchInputId, tableBodyId);
        }

        /**
         * Toggles the visibility of the details row for a given sample box.
         * It also updates a data attribute to remember the user's explicit expanded state and button text.
         * @param {number} index - The index of the sample box whose details row needs to be toggled.
         * @param {HTMLElement} button - The button element that triggered the toggle.
         */
        function toggleDetails(index, button) {
            const detailRow = document.getElementById(`details-row-${index}`);
            if (detailRow) {
                // Toggle the 'hidden' class to show/hide the row
                const isHidden = detailRow.classList.toggle('hidden');
                // Update the 'data-user-expanded' attribute based on the new visibility
                detailRow.setAttribute('data-user-expanded', (!isHidden).toString());
                // Update button text
                button.textContent = isHidden ? 'Ver Detalles' : 'Ocultar Detalles';
            }
        }

        /**
         * Sets up the search functionality for a given table.
         * Filters table rows based on the search term entered by the user.
         * Properly handles associated detail rows, respecting their expanded state.
         * @param {string} inputId - The ID of the search input element.
         * @param {string} tableBodyId - The ID of the tbody element whose rows will be filtered.
         */
        function setupSearch(inputId, tableBodyId) {
            const searchInput = document.getElementById(inputId);
            const tableBody = document.getElementById(tableBodyId);
            if (!searchInput || !tableBody) {
                console.error(`Error: Search input '${inputId}' or table body '${tableBodyId}' not found.`);
                return;
            }

            // Get all main data rows (excluding detail rows)
            const mainRows = Array.from(tableBody.querySelectorAll('tr[data-search-term]'));

            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase().trim(); // Trim whitespace from search term

                mainRows.forEach(row => {
                    const rowSearchTerm = row.getAttribute('data-search-term');
                    const rowIndex = row.getAttribute('data-row-index');
                    const detailRow = document.getElementById(`details-row-${rowIndex}`);
                    const expandButton = row.querySelector('.expand-button'); // Get the button associated with this row

                    if (rowSearchTerm.includes(searchTerm)) {
                        row.classList.remove('hidden'); // Show main row
                        // If the detail row exists and was expanded by the user, show it.
                        if (detailRow && detailRow.getAttribute('data-user-expanded') === 'true') {
                            detailRow.classList.remove('hidden');
                            if (expandButton) expandButton.textContent = 'Ocultar Detalles';
                        } else {
                            if (expandButton) expandButton.textContent = 'Ver Detalles';
                        }
                    } else {
                        row.classList.add('hidden'); // Hide main row
                        if (detailRow) { // Always hide the detail row if its main row is hidden by search
                            detailRow.classList.add('hidden');
                            if (expandButton) expandButton.textContent = 'Ver Detalles'; // Reset button text
                        }
                    }
                });
            });
        }

        /**
         * Determines the appropriate CSS class for a microscope's status based on its 'status' property.
         * @param {Object} microscope - The microscope object.
         * @returns {string} The CSS class string.
         */
        function getMicroscopeStatusClass(microscope) {
            if (microscope.status.includes('Excelente')) {
                return 'text-green-600 font-medium';
            } else if (microscope.status.includes('Buen')) {
                return 'text-blue-600 font-medium';
            } else if (microscope.status.includes('Aceptable')) {
                return 'text-yellow-600 font-medium';
            } else if (microscope.status.includes('Requiere') || microscope.status.includes('Mal')) {
                return 'text-red-600 font-medium';
            }
            return 'text-gray-700'; // Default color if status doesn't match
        }

        // --- Mobile Menu Functionality ---
        document.addEventListener('DOMContentLoaded', () => {
            const menuToggle = document.getElementById('menu-toggle');
            const mobileMenuOverlay = document.getElementById('mobile-menu-overlay');
            const closeMenuButton = document.getElementById('close-menu');
            const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');

            if (menuToggle && mobileMenuOverlay && closeMenuButton) {
                menuToggle.addEventListener('click', () => {
                    mobileMenuOverlay.classList.add('open');
                    document.body.style.overflow = 'hidden'; // Prevent scrolling when menu is open
                });

                closeMenuButton.addEventListener('click', () => {
                    mobileMenuOverlay.classList.remove('open');
                    document.body.style.overflow = ''; // Restore scrolling
                });

                // Close menu when a link is clicked
                mobileNavLinks.forEach(link => {
                    link.addEventListener('click', () => {
                        mobileMenuOverlay.classList.remove('open');
                        document.body.style.overflow = '';
                    });
                });
            }
        });

        // --- Theme Toggle Functionality ---
        // Function to set the theme
        function setTheme(theme) {
            const body = document.body;
            const themeToggleButton = document.getElementById('theme-toggle');

            if (theme === 'dark') {
                body.classList.add('dark-mode');
                themeToggleButton.innerHTML = '<i data-lucide="sun" class="w-8 h-8"></i>'; // Sun icon for light mode
                // Adjust Three.js fog color for dark mode
                if (scene && scene.fog) {
                    scene.fog.color.setHex(0x000000); // Dark fog
                }
            } else {
                body.classList.remove('dark-mode');
                themeToggleButton.innerHTML = '<i data-lucide="moon" class="w-8 h-8"></i>'; // Moon icon for dark mode
                // Adjust Three.js fog color for light mode
                if (scene && scene.fog) {
                    scene.fog.color.setHex(0xf0f4f8); // Light fog, matching body background
                }
            }
            // Re-create Lucide icons after changing innerHTML
            lucide.createIcons();
            localStorage.setItem('theme', theme); // Save preference
        }

        // Ensure Three.js and table rendering start after the DOM is fully loaded
        window.onload = function() {
            initThreeJS(); // Initialize the 3D background
            loadAndRenderData(); // Load and render data from JSON

            // Apply saved theme on load
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                setTheme(savedTheme);
            } else {
                // Default to light mode if no preference is found
                setTheme('light');
            }

            // Event listener for theme toggle button
            document.getElementById('theme-toggle').addEventListener('click', () => {
                const currentTheme = localStorage.getItem('theme') || 'light';
                const newTheme = currentTheme === 'light' ? 'dark' : 'light';
                setTheme(newTheme);
            });
        };
    </script>
</body>
</html>

